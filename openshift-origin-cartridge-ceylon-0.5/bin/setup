#!/bin/bash -e
set -u
set -x

version=0.5
PATH=/bin:/usr/bin:$PATH
cartridge_type="ceylon-${version}"

echo "export OPENSHIFT_CEYLON_VERSION='$version'" > "$OPENSHIFT_CEYLON_DIR/env/OPENSHIFT_CEYLON_VERSION"

CEYLON_HOME=/usr/lib/ceylon/${version}
CEYLON_USER_REPO=$APP_HOME/app-root/data/ceylon/repo
CART_DIR=$APP_HOME/$cartridge_type
APP_LOG_DIR=${CART_DIR}/log

echo "export CEYLON_HOME=$CEYLON_HOME" > $APP_HOME/.env/CEYLON_HOME
echo "export CEYLON_USER_REPO=$CEYLON_USER_REPO" > $APP_HOME/.env/CEYLON_USER_REPO

# Create additional directories 
mkdir -p ${CEYLON_USER_REPO}
mkdir -p ${APP_LOG_DIR}

# Copy the version specific files up to ceylon directory
#TODO cp -r ${OPENSHIFT_CEYLON_DIR}/versions/${version}/standalone/configuration/* ${OPENSHIFT_CEYLON_DIR}/standalone/configuration
